IpAddr: union = {
    V4: (u8, u8, u8, u8),
    V6: str,
    to_str: fn (&mut this) -> str {
        if |&v4| (*this as IpAddr::V4) {
            return "${v4.0}.${v4.1}.${v4.2}.${v4.3}";
        } else if |v6| (*this as IpAddr::V6) {
            return v6;
        }
    }
}
main: fn = {
    v4 := IpAddr::V4 ((192, 168, 1, 0));
    v6 := IpAddr::V6 ("2001:db8:1234");
    v4.to_str().test::print();
    v6.to_str().test::print();
}
